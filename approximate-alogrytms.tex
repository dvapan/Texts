\chapter{Алгоритмы аппроксимации}
\label{ch:algrhtms}

%Опишем два алгоритма --- этого и предыдущего года

В этой главе опишем два алгоритма для численной аппроксимации
множества достижимости

\section{Переборный алгоритм}
\label{sec:simple_alg}

Отметим, что интегральное ограничение в
\eqref{system_s} и условия, накладываемые на функции $f(t,x)$ и $G(t,x),$
обеспечивают компактность и связность множества достижимости, а
также его непрерывную зависимость от величины интегрального
ресурса управления $V$. Проведем преобразование системы
\eqref{system_s} при помощи разрывной замены времени. 

Аппроксимация множества достижимости импульсной системы осуществляется по
следующей схеме:
\begin{enumerate}
\item Задается разбиение отрезка $[b-a,b-a+V]$ на $k$ частей точками:
  $ \Delta=\big\{ \tau_{0}, \tau_{1}, \ldots, \tau_{k} \big\}, $ где
  $\tau_{0}=b-a< \tau_{1}< \ldots < \tau_{k}=b-a+V$. Положим
  $h_i:=\tau_{i}-\tau_{i-1},$ $i=\overline{1,k}$;
\item для каждого фиксированного $\tau_{i},$ $i=\overline{1,k},$
  численно строится оценка множества достижимости вспомогательной
  системы $\mbox{\bf R}_i ,$ т.е.
  ${\mathcal R}_{\mbox{\rm auxiliary}}(\tau_{i}) \approx \mbox{\bf
    R}_i$;
\item оценку множетсва достижимости исходной импульсной системы \eqref{system_s} с
  разрывными траекториями получаем путем объединения множеств
  $\mbox{\bf R}_i$, $i=\overline{0,k},$ т.е.
  $ {\mathcal R}_M(b)\approx \bigcup_{i=0}^k \mbox{\bf R}_i$.
\end{enumerate}


Рассмотрим кусочно-постоянные управления
$(\omega_0(\cdot),\omega_1(\cdot),\omega_2(\cdot))$, соответствующие
$\Delta$ и удовлетворяющие условиям:
\begin{equation*}
  \begin{array}{l}
    \sum_{j=1}^k \omega_{0j}h_j=b-a\\
    \omega_{0j}, \omega_{1j}, \omega_{2j} \geq 0,\\ 
    \omega_{0j}+ \omega_{1j}+ \omega_{2j} =1, \ \ j=\overline{1,k}.
  \end{array}
\end{equation*}

Пусть $\Omega(\Delta)$  --- множество всех таких управлений,
компоненты которых принимают значения либо 0 либо 1. Тогда
всевозможные выпуклые комбинации элементов $\Omega$ дают все
кусочно постоянные управления, соответствующие выбранному
разбиению. 
Заметим, что количество элементов в $\Omega(\Delta)$
не превышает  $m^{k-q} C_k^q,$ где $q=\left[\frac{b-a}{h}\right]$
--- число отрезков, на которых $\omega_{0j}=1$.
Элементы $\Omega(\Delta)$ полностью определяются номерами
компонент с единичными значениями. Например, если $T=[0,1]$,
$\tau_1=3$ --- конечный момент времени во вспомогательной системе,
$k=3$ --- количество подотрезков разбиения, то $\Omega(\Delta)$
задается множеством $\left\{122; 123 ; 132 ; 133  ;212 ; 213; 312
; 313 ; 221; 231 ; 321 ; 331   \right\}.$ Для построения точки
множества достижимости случайным образом выбираются несколько управлений из
$\Omega(\Delta)$, строится их выпуклая комбинация со случайным
образом выбранными весами, затем с полученным управлением решается
система и конечная точка включается в оценку множества достижимости.

%  TODO Дальше про проблемы с перебором и второй алгоритм