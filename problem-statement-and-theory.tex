\chapter{Постановка задачи. Теория}
\label{ch:theory}

% Расскажем об импульсных динамических системах подробнее и подведем %
% соотв. теоретическую базу.
%\section {Импульсные управления}
\section {Импулсьная управляемая система}
% Опишем здесь множество траекторий импульсной
% управляемой системы с траекториями ограниченной вариации и ее
% множество достижимости в конечный момент времени.

Для начала взглянем на обычную управляемую систему, расширение
множества траекторий которой и приводит к импульсной системе. Будем
работать с системой следующего вида

\begin{equation}
  \label{system_s}
  \begin{array}{l}
    \dot{x}(t)=f\big(x(t)\big)+G\big(x(t)\big)v(t), \quad x(0)=x_0, \\[8pt]
    v(t)\geq 0  \qquad \forall\, t\in T = [0,t_1], \qquad
    \displaystyle\int_{0}^{t_1} ||v(t)||dt\leq V.
  \end{array} \tag{$S$}
\end{equation}

Здесь
\begin{itemize}
  \item $||v||:=\displaystyle\sum_{i=1}^m |v_i|$
  \item $x(\cdot)$ --- абсолютно непрерывная вектор-функция
    (траектория), $x(t)\in {\mathbb R}^n,$
  \item $v(\cdot)$ --- измеримая существенно ограниченная
    вектор-функция (управление),
  
  \item $V$ --- заданная величина интегрального ресурса управления
    $v$.
\end{itemize}

Пару функций $\bigl(x(\cdot),v(\cdot)\bigr),$ удовлетворяющих
системе \eqref{system_s}, будем называть процессом системы \eqref{system_s}.

Будем предполагать, что вектор-функция $f$ является функцией из
$L_{\infty}(T,\mathbb{R}^2)$, а $G$ задана следующим правилом:

\begin{equation*}
  G(x) = 
  \begin{pmatrix}
    a x_2+b & 0\\ 0 & c x_1 +d 
  \end{pmatrix}
\end{equation*}
     

Отметим особенность системы \eqref{system_s}. В ней управление $v$ входит в
правую часть системы линейно и может принимать сколь угодно большие
значения. Это позволяет траекториям системы \eqref{system_s} сколь угодно близко
(в поточечном смысле) приближаться к разрывным функциям.  Например,
последовательность $\{v_k(\cdot)\}$, состоящая из допустимых
$v$-управлений:

\begin{equation*} 
  v_k(t)=\left\{ 
    \begin{array}{ll}
      0, & t \in \left[0,\tau\right)\\
      kV,  & t\in \left[\tau,\tau+\frac{1}{k}\right)\\
      0,  & t\in \left[\tau+\frac{1}{k},t_1\right]
    \end{array}
  \right.
\end{equation*}

Такая последовательность
называется дельтообразной. В данном случае она моделирует в точке
$t=\tau$ импульс интенсивности $V$.  Положим $f\equiv 0,$
$G\equiv 1$. Тогда соответствующая последовательность траекторий:
\begin{equation*}
  x_{k}(t)=\left\{
    \begin{array}{ll}
      x_0, & t \in \left[0,\tau \right), \\
      x_0+kV(t-\tau) & t \in \left[\tau,\tau+\frac{1}{k} \right),\\
      x_0+V, & t\in [\tau,t_1].
    \end{array} \right.
\end{equation*}

поточечно сходится к разрывной функции

\begin{equation*}
  x_{\infty}(t)=\left\{
    \begin{array}{ll}
      x_0, & t \in \left[0,\tau \right), \\
      x_0+V, & t\in [\tau,t_1].
    \end{array} \right.
\end{equation*}

Данная особенность системы \eqref{system_s} приводит, в частности, к тому, что
поставленные в ней задачи оптимизации, как правило, не будут иметь
решения в классе обычных процессов, т.е. абсолютно непрерывных
траекторий и измеримых ограниченных управлений. При этом
минимизирующие последовательности траекторий могут поточечно сходиться
к разрывным функциям.

% Заметим, что множество обычных траекторий системы $(S)$ будет состоять
% из функций, имеющих равномерно ограниченные полные вариации на отрезке
% $[0,T]$. Следовательно, любая последовательность траекторий будет
% содержать подпоследовательность, поточечно сходящуюся к некоторой
% функции ограниченной вариации. Именно такие функции, являющиеся
% поточечными пределами последовательностей обычных траекторий, в
% дальнейшем будут называться разрывными (или обобщенными) решениями
% системы $(S)$.

%TODO Надо подумать, как подробнее расписать этот текст, чтобы он был
%понятен сам по себе, а не только с привлечением очень серьезного контекста
Возникает необходимость корректно определить решения системы
\eqref{system_s}. Опишем вначале множество импульсных управлений. Пусть $\mu$ ---
ограниченная борелевская мера на $T$, удовлетворяющая условию
\begin{equation*}
  \mu(E) \in \mathbb{R}_+^2 \ \forall E \in \mathcal{B}_T
\end{equation*}
где $\mathbb{R}_+^2 = \{v \in \mathbb{R}^2 | v \ge 0\}$, $B_T$ ---
множество всех подмножеств отрезка $T$. Пусть $\mu_c$ --- непрерывная
состовляющая в разложении Лебега меры $\mu$, $S_d(\mu) = \{ s \in T |
\mu(\{s\}) \neq 0\}$. Сопоставим мере $\mu$ набор измеримых функций
$\gamma(\mu) = \{ \omega_s(\cdot) \}_{s\in S_d(\mu)}$, компоненты
которого $\omega_s(\cdot)$ являющиеся парами
$\big(\omega_{1s}(\cdot),\omega_{2s}(\cdot)\big)$ определены на
соответсвующих отрезках $[0,d_s]$, где $d_s := \mu(\{s\})$, и
удовлетворяют условиям:
\begin{itemize}
  \item $\omega_{1s}(\tau) \ge 0$, $\omega_{2s}(\tau) \ge 0$, 
    $\omega_{1s}(\tau) + \omega_{2s}(\tau) = 1$, $\tau \in [0,d_s]$,
  \item $\displaystyle\int_{0}^{d_s} \omega(\tau) d\tau = \mu(\{s\})$.
\end{itemize}
Пару $(\mu,\gamma(\mu))$ будем называть импульсным управлением и
обозначать символом $\pi(\mu)$.

Введем понятие ресурса импульсного управления. Для векторной меры
$\mu$ полную вариацию обозначим через $|\mu|$ и зададим правилом
\begin{equation*}
  |\mu|(E) = |\mu_1|(E) + |\mu_2|(E) \ \forall E \in \mathcal{B}_T,
\end{equation*}
где $\mu_1,\mu_2$ --- компоненты $\mu$, причем в силу
неотрицательности $|\mu_i| = \mu_i$, $i=1,2$. Тогда ресурсом
управления $\pi(\mu)$ назовем величину $|\mu|(T)$, а ограничением на
ресурс импульсного управления --- неравенство

\begin{equation}
  \label{eq:mu_res}
  |\mu|(T) \le V,
\end{equation}
где $V \ge 0$ --- заданное действительное число. Множество импульсных
управлений удовлетворяющих ограничению \eqref{eq:mu_res}, будем
обозначать $\mathcal{W}(T)$.

%TODO Дописать как обычная система расширяется до импульсной

% Таким образом, при расширении системы $(S)$ и переходе к
% соответствующей импульсной системе $({\mathcal D})$ мы к обычным
% (абсолютно непрерывным) траекториям добавляем все частичные
% поточечные пределы последовательностей обычных
% траекторий. Полученное множество будем называть множеством
% траекторий импульсной системы, соответствующей $(S)$ и будем
% обозначать импульсную систему символом $({\mathcal D}).$ Поясним,
% что если в системе $({\mathcal D})$ траектории могут иметь скачки,
% то их обобщенные производные будут содержать дельтообразные
% составляющие --- импульсы; следовательно, импульсы появятся в
% соответствующих управлениях, отсюда и названия импульсной системы и
% импульсного управления.

%                   Приведем определение траекторий импульсной системы
% $({\mathcal D}).$

%                   {\bf Определение 1.} {\it Функция $x(\cdot)\in
% BV^n(T)$ называется решением (траекторией) импульсной системы
% $({\mathcal D})$ (или обобщенным (разрывным) решением системы $(S)$),
% если найдется такая последовательность процессов системы $(S)$
%                     $$ \bigl\{\bigl(x_k(\cdot), v_k(\cdot)\bigr)\bigr\},$$ что выполняется условие
%                     % \begin{align} % & \displaystyle\sup_k
% $||v_k||_{L_1}<+\infty,$ % \\ &
%                     $$ x_k(t)\to x(t) \quad  \forall \, t\in T.$$
%                     % \end{align} Здесь $BV^n(T)$ --- банахово
% пространство $n$-мерных функций ограниченной вариации на $T$ с нормой
%                     $$||x||_{BV^n}=||x||_{L_\infty}+\displaystyle\mathop{\rm var }_{T}x(\cdot).$$
%                   }

%                     Определим \emph{множество достижимости} в момент
%                     времени $t=b$ импульсной системы
%                     $({\mathcal D}).$ Обозначим это множество через
%                     $ {\mathcal R}_M(b).$ Это множество из
%                     пространства ${\mathbb R}^n$ (конечномерное
%                     множество), оно состоит из точек $x_b,$ в
%                     которые в момент $t=b$ попадают траектории
%                     системы $({\mathcal D}),$ выходящие в начальный
%                     момент из начальной точки $x_0;$ точнее
%                   $$ {\mathcal R}_M(b):=\left\{
%                     x(b+) \ \big| \ x(\cdot) \mbox{ -- траектория
% системы } ({\mathcal D}) \mbox{ в смысле опр. 1} \right\}.$$

% Укажем важные свойства множества достижимости \cite{ZS1991, SS2010}:

% \begin{itemize}
% \item[ 1)] Множество достижимости ${\mathcal R}_M(b)$ является
%   компактным множеством в ${\mathbb R}^n.$
%                   \item[ 2)] Множество достижимости ${\mathcal
% R}_M(b)$ является связным множеством в ${\mathbb R}^n,$ т.е. его
% нельзя представить в виде объединения двух непустых непересекающихся
% подмножеств.
%                   \item[ 3)] Множество достижимости ${\mathcal
% R}_M(b)$ непрерывно зависит от величины интегрального ресурса
% управления $M.$ Напомним, что множество ${\mathcal R}_m(b)$ непрерывно
% зависит от параметра $m$ при $m=M,$ если
%                     \begin{equation} \lim_{m\to M} \rho\Big( {\mathcal
% R}_m(b) , {\mathcal R}_M(b) \Big) =0 ,
%                     \end{equation} где $\rho(A,B):=\max\bigl\{
% \max\limits_{y\in A}\min\limits_{z\in B} |y-z| ; \max\limits_{z\in
% B}\min\limits_{y\in A} |y-z| \bigr\}$ --- хаусдорфово расстояние между
% двумя компактными множествами $A$ и $B.$ \end{itemize}

% Эти свойства будут очень важны при численном построении внутренних
% аппроксимаций множества достижимости.  В частности, свойство 3)
% позволяет приближенно рассматривать множество достижимости как
% некоторое конечное объединение множеств достижимости вспомогательной
% системы, описанной в следующем разделе.
